(function(s,n){typeof exports=="object"&&typeof module<"u"?n(exports,require("vuex"),require("vue")):typeof define=="function"&&define.amd?define(["exports","vuex","vue"],n):(s=typeof globalThis<"u"?globalThis:s||self,n(s["ui-dropdown-cdl"]={},s.vuex,s.Vue))})(this,function(s,n,l){"use strict";const d=(e,t)=>{const o=e.__vccOpts||e;for(const[i,a]of t)o[i]=a;return o},p={name:"UIDropdownCDL",inject:["$socket","$dataTracker"],props:{id:{type:String,required:!0},props:{type:Object,default:()=>({})},state:{type:Object,default:()=>({enabled:!1,visible:!1})}},setup(e){},data(){return{value:"",fromManual:!1}},computed:{...n.mapState("data",["messages"]),color:function(){let e="";return this.fromManual&&(e=this.props.waitingcolor??""),e},options:function(){return this.expandedOptions().map(e=>e.label)}},created(){this.$dataTracker(this.id,this.onInput,this.onLoad,this.onDynamicProperties)},methods:{send(e){this.$socket.emit("widget-action",this.id,e)},onInput(e){this.$store.commit("data/bind",{widgetId:this.id,msg:e}),e&&this.processMsg(e)},onLoad(e,t){e&&this.processMsg(e)},onDynamicProperties(e){const t=e.ui_update;t&&["options","topic"].forEach(i=>{if(typeof t[i]<"u"){let a={};a[i]=t[i],this.setDynamicProperties(a)}})},alert(e){alert(e)},expandedOptions(){let e=this.getProperty("options");return e.forEach((t,o,i)=>{(typeof t.label!="string"||t.label.length===0)&&(t.label=t.value)}),e},processMsg:function(e){var t;if(typeof e.payload=="string"&&this.expandedOptions().find(o=>o.value===e.payload)){this.fromManual=!1;const o=(t=this.expandedOptions().find(i=>i.value===e.payload))==null?void 0:t.label;o!==this.value&&(this.value=o,this.valueFromMsg=!0)}}},watch:{value:function(){var e;if(this.valueFromMsg)this.valueFromMsg=!1;else{this.fromManual=!0;let t={};t.payload=(e=this.expandedOptions().find(o=>o.label===this.value))==null?void 0:e.value,t.topic=this.getProperty("topic"),this.send(t)}}}},u={className:"ui-dropdown-cdl-wrapper"};function c(e,t,o,i,a,r){const h=l.resolveComponent("v-select");return l.openBlock(),l.createElementBlock("div",u,[l.createVNode(h,{label:o.props.label,variant:"outlined",modelValue:a.value,"onUpdate:modelValue":t[0]||(t[0]=m=>a.value=m),"hide-details":"",items:r.options,"bg-color":r.color,disabled:!e.getProperty("enabled")},null,8,["label","modelValue","items","bg-color","disabled"])])}const f=d(p,[["render",c],["__scopeId","data-v-d218a25c"]]);s.UIDropdownCDL=f,Object.defineProperty(s,Symbol.toStringTag,{value:"Module"})});
